%
O01010
(MESH PROBE OF TABLE SURFACE)

(REQUIRED MACRO ASSIGNMENTS:)
#1 = 25 (PROBE TOOL OFFSET NUMBER)
#2 = 30 (X TABLE DIMENSION IN INCHES)
#3 = 18 (Y TABLE DIMENSION IN INCHES)
#4 = 1 (X PROBE GRID CELL SIZE INCHES)
#5 = 1 (Y PROBE GRID CELL SIZE INCHES)
#6 = 0 (RESERVED FOR FUTURE USE)

(OPTIONAL MACRO VARIABLE ASSIGNMENTS)
#7 = 54 (G54 WORK COORDINATE SET)
#8 = 12. (STARTING Z PLANE)
#9 = 0.5 (PROTECTED Z HEIGHT BEFORE PROBING)
#10 = 0 (Z DEPTH RELATIVE G54Z0. PROBING TABLE, SO Z0)
#11 = 0 (RETRACT TO #8 AFTER EACH POINT? 0= NO, 1= YES)

G103 P1 



DPRNT [#2[40], #3[40]]
G90 G80 G40 G0 (PREP CODES)

G53 Z0 (RAPID MOVE TO MACHINE ZERO IN Z- SAFE DISTANCE)
G#7 X0 Y0 (RAPID MOVE TO G54 XY HOME)
T#1 M6
G43 H#1 Z#8 (ACTIVATE TOOL OFFSET 1 AND RAPID MOVE TO Z#8- DEFAULT 12.)

G65 P9832 (SPIN THE PROBE ON)

(MESH PROBING- NESTED LOOP: XY POS, PROBE,  INCREMENT X THROUGH RANGE OF X THEN INCREMENT Y)
#20 = 0 (ZERO X COUNTER)
#21 = 0 (ZERO Y COUNTER)

N100
G#7 X[ [ #2 / #4 ] * #20 ] Y[[ #3 / #5 ] * #21 ] (MOVE TO INDEXED XY POS)
G65 P9810 Z#9 (PROTECTED MOVE TO .5 ABOVE SURFACE)
G65 P9811 Z#10 (PROBE SURFACE- DEFAULT OVERTRAVEL IS 4MM BELOW SURFACE)
IF [ #11 = 0 ] GOTO200
G65 P9810 Z#8
N200 
DPRNT [ #187 [ 44 ] ]
#21 = #21 + #5 (INCREMENT Y COUNTER)
IF [ ROUND [ #21 ] GT #3 ] GOTO500(CHECK FOR Y COMPLETION)

N500(RESET Y COUNTER, INCREMENT X COUNTER)
DPRNT [](PRINT BLANK LINE TO END DATA BLOCK)
#21 = 0
#20 = #20 + 1
IF [ ROUND [ #20 ] GT #2 ] GOTO600 (CHECK FOR X COMPLETION)
GOTO100(RETURN TO LOOP)

N600(FINISH)
G65 P9833 (PROBE OFF)
G53 G0 Z0
G40
G53 X0Y0
M30

